---
// Skills.astro
import NumberedHeading from './NumberedHeading.astro'
import { cn } from '../lib/utils/utils'

const TAGS = [
  'HTML5',
  'CSS3',
  'JavaScript',
  'TypeScript',
  'React.js',
  'Next.js',
  'Node.js',
  'Webpack',
  'WordPress',
  'WooCommerce',
  'Git',
  'GitHub',
  'Bitbucket',
  'npm',
  'REST API',
  'UI/UX Design',
  'Responsive Design',
  'SEO',
  'Adobe Creative Suite',
  'PHP',
  'MySQL',
  'AWS',
  'API Development',
  'WebGL',
  'VR/AR',
]

const DURATION = 18000
const ROWS = 5
const TAGS_PER_ROW = 8

const random = (min: number, max: number): number =>
  Math.floor(Math.random() * (max - min)) + min

const shuffle = (arr: string[]): string[] =>
  [...arr].sort(() => 0.5 - Math.random())

// Generate rows data at build time
const rows = [...new Array(ROWS)].map((_, i) => ({
  duration: random(DURATION - 5000, DURATION + 5000),
  reverse: i % 2 === 0,
  tags: shuffle(TAGS).slice(0, TAGS_PER_ROW),
}))
---

<section
  id='skills'
  class='py-8 lg:py-32'
>
  <div class={cn('container mx-auto px-4 lg:max-w-[900px]')}>
    <NumberedHeading
      number='03.'
      title='Skills & Technologies'
    />
    <div>
      <div
        class='lg:max-w-[48rem] flex flex-shrink-0 flex-col gap-y-4 relative py-6 overflow-hidden'
      >
        {
          rows.map(({ duration, reverse, tags }) => (
            <div
              class='loop-slider'
              style={`--duration: ${duration}ms; --direction: ${reverse ? 'reverse' : 'normal'};`}
            >
              <div class='inner flex w-fit'>
                {/* Double the tags for seamless loop */}
                {[...tags, ...tags].map((tag) => (
                  <div
                    class={cn(
                      'tag bg-honolulu text-nonphoto flex items-center py-[0.7rem] rounded-md px-4 mr-4 shadow-md whitespace-nowrap',
                      'shadow-[0_0.1rem_0.2rem_rgba(3,4,94,0.2),0_0.1rem_0.5rem_rgba(3,4,94,0.3),0_0.2rem_1.5rem_rgba(3,4,94,0.4)]'
                    )}
                  >
                    <span class='text-pacific'>#</span> {tag}
                  </div>
                ))}
              </div>
            </div>
          ))
        }
        <div
          class='pointer-events-none absolute inset-0 bg-gradient-to-r from-federal via-transparent to-federal'
        >
        </div>
      </div>
    </div>
  </div>
</section>
